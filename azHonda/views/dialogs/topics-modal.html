
<style>
    /**
    * For the correct positioning of the placeholder element, the dnd-list and
    * it's children must have position: relative
    */
    .typesDemo ul[dnd-list],
    .typesDemo ul[dnd-list] > li {
        position: relative;
    }

    /**
    * The dnd-list should always have a min-height,
    * otherwise you can't drop to it once it's empty
    */
    .typesDemo ul[dnd-list] {
        min-height: 42px;
        padding-left: 0px;
    }

        /**
    * The dndDraggingSource class will be applied to
    * the source element of a drag operation. It makes
    * sense to hide it to give the user the feeling
    * that he's actually moving it.
    */
        .typesDemo ul[dnd-list] .dndDraggingSource {
            display: none;
        }

        /**
    * An element with .dndPlaceholder class will be
    * added to the dnd-list while the user is dragging
    * over it.
    */
        .typesDemo ul[dnd-list] .dndPlaceholder {
            display: block;
            background-color: #ddd;
            min-height: 42px;
        }

        /**
    * The dnd-lists's child elements currently MUST have
    * position: relative. Otherwise we can not determine
    * whether the mouse pointer is in the upper or lower
    * half of the element we are dragging over. In other
    * browsers we can use event.offsetY for this.
    */
        .typesDemo ul[dnd-list] li {
            background-color: #fff;
            border: 1px solid #ddd;
            border-top-right-radius: 4px;
            border-top-left-radius: 4px;
            display: block;
            padding: 2px 5px;
            margin-bottom: -1px;
            /* Disable text selection if item is not draggable */
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

    .Topic {
        color: #4070A0;
    }

    .Subsection {
        color: #FA4D40;
    }

    .Question {
        color: #76975A;
    }

    .Command {
        color: #F7AB29;
    }

    .typesDemo ul[dnd-list] li {
        max-width: 98%;
        border-color: transparent;
        background-color: transparent;
    }

        .typesDemo ul[dnd-list] li.Topic {
            border-color: #9DC4EA;
        }

        .typesDemo ul[dnd-list] li.Subsection {
            border-color: #FE9189;
        }

        .typesDemo ul[dnd-list] li.Question {
            border-color: #B1D790;
        }

        .typesDemo ul[dnd-list] li.Command {
            border-color: #FFDA97;
        }

    .glyphicon-plus-sign {
        margin-left: 3px;
    }

    .glyphicon {
        cursor: pointer;
    }
    /**
    * Handle positioning
    */
    .typesDemo .handle {
        cursor: move;
        position: absolute;
        top: 14px;
    }

    .typesDemo .content {
        margin-left: 5px;
    }

    /**
    * delete sign positioning
    */
    .typesDemo .deleteSign {
        cursor: pointer;
        position: absolute;
        top: -10px;
        right: -10px;
        font-size: large;
    }

    a {
        cursor: pointer;
    }

    .typesDemo .deleteSign > span {
        background-color: white;
    }

    div .typesDemo{
        margin-bottom: 5px;
    }
</style>


<md-dialog aria-label="title" flex="80">
    <!-- use flex to control dialog size  flex="50" -->
    <form ng-cloak>
        <md-toolbar>
            <div class="md-toolbar-tools">
                <h2 style="color:white !important">{{title}}</h2>
            </div>
        </md-toolbar>

        <md-dialog-content>
            <div class="md-dialog-content" style="text-align:left">
                <!--<md-content>-->
                    
                    <div ng-repeat="Topic in Topics" class="typesDemo" layout="column">

                        <div layout="column" layout-fill>
                            <div layout="row" layout-wrap>
                                <div flex="95">
                                    <a ng-click="toggleExpand(Topic)" ng-if="!Topic.ctrl_IsEdit">
                                        <span ng-class="{'glyphicon glyphicon-menu-right': !Topic.ctrl_IsExpand, 'glyphicon glyphicon-menu-down': Topic.ctrl_IsExpand}"></span>
                                        {{Topic.Subject}}
                                    </a>
                                </div>
                                <div ng-if="!Topic.ctrl_IsEdit && isAllowEdit" flex="5" layout="row">
                                    <span class="glyphicon glyphicon-edit" ng-click="EditTopic(Topic)" style="margin-left: 3px;"></span>
                                    <span class="glyphicon glyphicon-trash" ng-click="DeleteTopic(Topic)" style="margin-left: 5px;"></span>
                                </div>
                            </div>
                            <div layout="row" layout-wrap>
                                <md-input-container class="md-block" ng-if="Topic.ctrl_IsEdit" flex="90">
                                    <label>Topic</label>
                                    <textarea ng-model="Topic.Subject" md-maxlength="200" rows="2"></textarea>
                                </md-input-container>
                                <div ng-if="Topic.ctrl_IsEdit" flex="10" style="text-align: right;">
                                    <span ng-click="SaveChange(Topic)" class="md-accent md-raised md-hue-1">
                                        <i class="material-icons">save</i>
                                        <!--<span style="vertical-align:central">Save</span>-->
                                    </span>
                                    <span ng-click="CancelChange(Topic)" class="md-accent md-raised md-hue-1" style="margin-left: 3px;">
                                        <i class="material-icons">cancel</i>
                                        <!--<span style="vertical-align:central">Save</span>-->
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div ng-if="Topic.ctrl_IsExpand || Topic.ctrl_IsEdit">
                            <md-subheader class="md-no-sticky Subsection" ng-if="Topic.ctrl_IsEdit">
                                Subsections
                                <span id="btnAddSubsection" class="glyphicon glyphicon-plus-sign" ng-click="addSubsection(Topic.Subsections)"></span>
                            </md-subheader>

                            <ul dnd-list="Topic.Subsections"
                                dnd-allowed-types="Subsection">
                                <li ng-repeat="Subsection in Topic.Subsections"
                                    dnd-draggable="Subsection"
                                    dnd-type="'Subsection'"
                                    dnd-moved="Topic.Subsections.splice($index, 1)"
                                    dnd-disable-if="!Topic.ctrl_IsEdit"
                                    dnd-effect-allowed="move"
                                    ng-class="{'Subsection': Topic.ctrl_IsEdit}">
                                    <div class="handle" ng-if="Topic.Subsections.length > 1 && Topic.ctrl_IsEdit">
                                        <span class="glyphicon glyphicon-move"></span>
                                    </div>

                                    <div class="content" dnd-nodrag>
                                        <div layout="column">
                                            <div flex>
                                                <a ng-click="toggleExpand(Subsection)" ng-if="!Topic.ctrl_IsEdit">
                                                    <span ng-class="{'glyphicon glyphicon-menu-right': !Subsection.ctrl_IsExpand, 'glyphicon glyphicon-menu-down': Subsection.ctrl_IsExpand}"></span>
                                                    {{Subsection.Name}}
                                                </a>
                                                <md-input-container class="md-block" ng-if="Topic.ctrl_IsEdit" flex-gt-sm>
                                                    <label>Subsection</label>
                                                    <textarea ng-model="Subsection.Name" md-maxlength="200" rows="2"></textarea>
                                                </md-input-container>
                                            </div>
                                            <!-- Subsection Node-->
                                            <div flex style="padding-left:20px;" ng-if="(Subsection.ctrl_IsExpand && Subsection.Value) || (Topic.ctrl_IsEdit && Subsection.Questions.length == 0)">
                                                <div ng-if="!Topic.ctrl_IsEdit" ng-bind-html="Subsection.Value"></div>
                                                <summernote height="100" ng-if="Topic.ctrl_IsEdit" ng-model="Subsection.Value"></summernote>
                                            </div>
                                        </div>

                                        <div class="content" ng-if="Subsection.ctrl_IsExpand || Topic.ctrl_IsEdit">
                                            <md-subheader class="md-no-sticky" style="color:darkseagreen" ng-if="Topic.ctrl_IsEdit && !Subsection.Value">
                                                Questions
                                                <span id="btnAddQuestion" class="glyphicon glyphicon-plus-sign" ng-click="addQuestion(Subsection.Questions)"></span>
                                            </md-subheader>

                                            <ul dnd-list="Subsection.Questions"
                                                dnd-allowed-types="Question" ng-if="Subsection.Questions.length > 0"> <!-- Toggle Questions OR Subsection Value-->
                                                <li ng-repeat="Question in Subsection.Questions"
                                                    dnd-draggable="Question"
                                                    dnd-type="Question"
                                                    dnd-moved="Subsection.Questions.splice($index, 1)"
                                                    dnd-disable-if="!Topic.ctrl_IsEdit"
                                                    dnd-effect-allowed="move"
                                                    ng-class="{'Question': Topic.ctrl_IsEdit}">
                                                    <div class="handle" ng-if="Subsection.Questions.length > 1 && Topic.ctrl_IsEdit">
                                                        <span class="glyphicon glyphicon-move"></span>
                                                    </div>

                                                    <div class="content" dnd-nodrag>
                                                        <div layout="column" style="color:darkseagreen">
                                                            <div>
                                                                <a ng-click="toggleExpand(Question)" ng-if="!Topic.ctrl_IsEdit">
                                                                    <span ng-class="{'glyphicon glyphicon-menu-right': !Question.ctrl_IsExpand, 'glyphicon glyphicon-menu-down': Question.ctrl_IsExpand}"></span>
                                                                    {{Question.Name}}
                                                                </a>
                                                                <md-input-container class="md-block" ng-if="Topic.ctrl_IsEdit" flex-gt-sm>
                                                                    <label>Question</label>
                                                                    <textarea ng-model="Question.Name" md-maxlength="200" rows="2"></textarea>
                                                                </md-input-container>
                                                            </div>

                                                            <!--Question Node-->
                                                            <div ng-if="Question.ctrl_IsExpand || Topic.ctrl_IsEdit">
                                                                <div style="padding: 5px 2px; margin-left: 10px;" ng-if="!Topic.ctrl_IsEdit" ng-bind-html="Question.Value"></div>
                                                                <!--<div summernote ng-model="Question.Value"></div>-->
                                                                <summernote height="100" ng-if="Topic.ctrl_IsEdit" ng-model="Question.Value"></summernote>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="deleteSign">
                                                        <span ng-if="Topic.ctrl_IsEdit" ng-click="Subsection.Questions.splice($index, 1)" class="glyphicon glyphicon-remove-sign hand"></span>
                                                    </div>
                                                </li>
                                                <li class="dndPlaceholder Question">
                                                    Drop any <strong>Question</strong> here
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="deleteSign">
                                        <span ng-if="Topic.ctrl_IsEdit" ng-click="Topic.Subsections.splice($index, 1)" class="glyphicon glyphicon-remove-sign hand"></span>
                                    </div>
                                </li>
                                <li class="dndPlaceholder Subsection">
                                    Drop any <strong>Subsection</strong> here
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- No row Messege-->
                    <div ng-if="isAllowEdit && Topics.length == 0">
                        {{title}} has enacted no statute specifically regulating distributor relationships for marine engines.
                    </div>

                <!--</md-content>-->
            </div>
        </md-dialog-content>

        <!--Dialog Controls-->
        <md-dialog-actions layout="row">
            <!--<md-button ng-click="print()">
                Print Document
            </md-button>-->
            <md-button ng-if="isAllowEdit" ng-click="AddNewTopic()">
                Add Topic
            </md-button>
            <md-button ng-click="CancelDialog()">
                close
            </md-button>
        </md-dialog-actions>
    </form>
</md-dialog>